---
output:  
  word_document:
    toc: no
    pandoc_args: ["-Fpandoc-crossref"]
fig_caption: yes
---

Sam C. Levin $^{\ast1,2,3}$, Sanne Evers $^{1,2}$, Tomos Potter$^{3}$, Mayra Pena-Guerrero $^{1,2}$,  Aldo Compagnoni $^{1,2,3}$, Dylan Z. Childs $^4$, Tiffany M. Knight $^{1,2,5\ddagger}$, Roberto Salguero-Gomez $^{3\ddagger}$

$^1$Institute of Biology, Martin Luther University Halle-Wittenberg, Am Kirchtor 1, 06108 Halle (Saale), Germany

$^2$German Centre for Integrative Biodiversity Research (iDiv) Halle-Jena-Leipzig, Deutscher Platz 5e, 04103 Leipzig, Germany

$^3$Department of Zoology, 11a Mansfield Rd, University of Oxford, Oxford, OX1 3SZ, UK

$^4$Department of Animal and Plant Sciences, University of Sheffield, Sheffield, S10 2TN, UK

$^5$Department of Community Ecology, Helmholtz Centre for Environmental Research-UFZ, Theodor-Lieser-Stra√üe 4, 06120, Halle (Saale), Germany

$^\ddagger$ Joint senior authors

$^*$Corresponding Author:

Sam C. Levin

Puschstrasse 4, 04103 Leipzig, Germany

email: <levisc8@gmail.com>

Target journal: Probably Methods in Ecology & Evolution, but open to other suggestions.


```{r echo = FALSE, message = FALSE, warning = FALSE}
library(dplyr)
library(purrr)
library(grid)
library(gridExtra)
library(ggplot2)
library(RPadrino)

ipm_pubs <- read.csv('../../metadata/all_ipm_papers_20210806.csv',
                     stringsAsFactors = FALSE)

names(ipm_pubs) <- gsub("\\.\\.", "_", names(ipm_pubs))
names(ipm_pubs) <- gsub("\\.$", "", names(ipm_pubs))
names(ipm_pubs) <- gsub("\\.", "_", names(ipm_pubs))

ipm_id <- pmap_chr(.l = data.frame(a = ipm_pubs$Authors,
                                   b = ipm_pubs$Journal, 
                                   c = ipm_pubs$Year),
               .f = function(a, b, c) paste(a, b, c, sep = "_")) 

ipm_pubs <- cbind(ipm_pubs, ipm_id)
ipm_pubs$Year <- as.integer(ipm_pubs$Year)

pub_tot  <- length(unique(ipm_id))

kingdoms <- ipm_pubs %>% 
  group_by(Kingdom) %>%
  summarise(N     = length(unique(Full_citation_APA)),
            n_spp = length(unique(Species)))


pdb <- pdb_download(save = FALSE)


tab <- pdb$Metadata %>% 
  group_by(kingdom) %>%
  summarise(
    IPMs = length(unique(ipm_id)),
    spp  = length(unique(species_accepted)),
    pap  = length(unique(apa_citation))
  )

tot <- pdb$Metadata %>% 
  summarise(
    kingdom = "Totals",
    IPMs = length(unique(ipm_id)),
    spp  = length(unique(species_accepted)),
    pap  = length(unique(apa_citation))
  ) %>%
  rbind(tab)




```


# Introduction

Demography is a key component of ecology and evolutionary biology (Metcalf & Pavard 2007). Environmental conditions and biotic interactions influence vital rates across the entire life cycle, often in different ways, with implications for both short term and long term fitness (XXXX). There is a rich history of using structured population models across a variey of sub-disciplines in ecology (_e.g._ Leslie 1945, Caswell 2001, Easterling et al. 2000, Adler et al. 2010, Ellner et al. 2016). Integral projection models (IPMs) are a relatively new, but increasingly important tool for ecologists interested in these fields (Easterling et al. 2000, Ellner & Rees 2006). IPMs have been used to investigate a variety of topics, such as invasive species spread (_e.g._ Jongejans et al. 2011, Erickson et al. 2017) to evolutionary stable strategies (_e.g._ Childs et al. 2004) to the effect of climate drivers on population persistence (Salguero-Gomez et al. 2012, Compagnoni et al. 2021a). To date, there are at least `r sum(kingdoms$N[1:2])` publications covering at least `r sum(kingdoms$n_spp[1:2])` species (SC Levin, unpublished data). The field of ecology would benefit from a source that enables researchers to reconstruct and analyze these models to address synthetic questions. 

Recent advances in the availability of structured demographic information have powered large scale syntheses to answer a variety of questions in both theoretical and applied ecology. For example, Jelbert and colleagues (2019) used a comprehensive database of discretely structured plant population models (COMPADRE, Salguero-Gomez et al. 2014) to show that demographic amplification predicts degree of invasiveness in new environmental contexts. Healy and colleagues (2019) used a separate database (COMADRE, Salguero-Gomez et al. 2015) to demonstrate how patterns of animal life history strategies are shaped by trade offs between distributions of age-specific mortality and reproduction. Hartemink & Caswell (2018) decomposed the variance in individual longevity into contributions from individual heterogeneity and individual stochasticity using a set of ten invertebrate species (DATLife Database 2021). The number of IPMs in the literature (Figure 1) indicates that there is a growing, yet currently untapped, source of data that can augment existing approaches and enable novel ones (e.g. Compagnoni et al. 2021b).  

IPMs are constructed from a set of continuous functions which represent vital rates. These are combined to form projection kernels which describe how the abundance and distribution of trait values in a population change in discrete time (Easterling et al. 2000). Analytical solutions to the integrals in these models are usually not possible(Ellner & Rees 2006), so they are numerically approximated, resulting in a large iteration matrix (ranging from $50 \times 50$ to $5000 \times 5000$ in size), and then some population-level quantities of interest are computed. The fact that these models rely on continuous functions, rather than discrete transition values, presents unique challenges with respect to creating a database to house them. Existing approaches to digitizing structured population models entail entering individual transition parameter values (_e.g._ COMPADRE and COMADRE). This would be difficult for the smallest IPMs, and impossible to do accurately for even modestly sized ones. However, the recent development of computational tools mean we can now create IPMs from their symbolic representations and the parameters used to implement them (Henry & Wickham 2021, Levin et al. 2021). A database containing the functional forms of sub-kernels and vital rate functions, and the parameter values that go into each of those, can accommodate nearly all of the existing IPM literature.

In this paper, we introduce PADRINO and _RPadrino_. PADRINO houses symbolic representations of IPMs, their parameter values, and associated metadata to aid users in selecting appropriate models. PADRINO is not opinionated in the sense that models are provided _as they are published_, and does not make any attempt to ensure they are biologically/technically correct (except to correct typographical errors in the publication itself). Furthermore, we do not store any raw data used to create the IPMs. _RPadrino_ provides functionality that enable users to reconstruct, and potentially modify, IPMs from PADRINO with _R_. First, we describe PADRINO's structure and how to interact with it using _RPadrino_. We discuss how models are digitized into the database and the challenges therein. We conclude with discussion of future directions for the database. We also provide a number of worked examples of how to use PADRINO and _RPadrino_ in the Supplementary Materials.

# PADRINO

PADRINO is an open-access database of integral projection models. PADRINO defines a syntax to symbolically represent IPMs as text strings, and stores the values of those symbols in a separate table. The syntax used is very similar to the mathematical notation of IPMs, and is intended to be largely "language-agnostic", meaning it tries to avoid idiosyncracies specific to certain programming languages (_e.g._ R or Julia). For example, a survival/growth kernel with the form $P(z',z) = s(z) * G(z',z)$ would be `P = s * G` in PADRINO's syntax. $G(z',z) = f_G(z'|\mu_g, \sigma_G)$ (where $f_G$ denotes a normal probability density function) becomes `G = Norm(mu_g, sd_g)`. This means that bindings to many languages should be possible provided that a translation layer exists between PADRINO and the language in question. 

PADRINO consists of 10 tables, stored on GitHub as _csv_ files. The table names and a brief description of each are provided in Table 1. Each table is linked to every other table by a common column, called `ipm_id`. For now, this takes the place of an SQL key, and ensures that all information pertaining to a given model is linked to every other piece of the model correctly (PADRINO will eventually become an SQL database hosted elsewhere, but is currently only on GitHub). The scope of each `ipm_id` is determined by the way that a model is parameterized. Models that characterize the same species across, for example, many years or sites, with the same functional form are considered included as a single `ipm_id`. One exception to this is when the sites (i.e. where the raw data are reported to have come from) are far enough apart that separate sets of GPS coordinates are used to describe them. These are split into separate `ipm_id`s so that the spatial distinctions are preserved, which facilitates matching PADRINO data with, for example, gridded environmental data. 

To date, we have incorporated and tested `r tot[3, 2]` IPMs for `r tot[3, 3]` species from `r tot[3, 4]` publications (Table 2). We are actively working on collecting and digitizing every published IPM we can find, though challenges arise in the process (see below). The digitization process begins when a paper containing an IPM is published. We start by entering the publication information on a private Google Spreadsheet that tracks digitization progress and who is responsible for that particular publication. Once the metadata is extracted from the publication (see Table 3 for details), we begin extracting functional forms of each sub-kernel, vital rate expression, how the environment varies (if applicable), all parameter values, as well as information on the domains of the traits used and how they are numerically approximated. Often times, not all information is present. Therefore, we often contact authors to request the required information and/or clarifications. We also extract a target value for the data validation step (see next section), so that we can ensure that released data really does replicate the published behavior. A complete guide to our digitization process and documentation of the database syntax are publicly available on PADRINO's webpage (https://levisc8.github.io/Padrino/).

```{r echo = FALSE}

cap <- "**Table 1**: Summaries of the information contained in each table of the PADRINO database. A complete guide to each column in each table is available on the project's webpage in the form of the guide provided to digitizers (there are too many columns to provide the information here)."

md_desc <- "This table contains metadata for each model. This is organized into taxonomic information (full taxonomy plus functional group information), publication information (citation, authorship, source), data collection information (study period/duration, GPS coordinates, ecoregion), and model specific information (studied sexes, eviction corrections, treatments applied, and model implementation details). See Table 3 for more information on these columns."

sv_desc <- "This table contains the names of the state variables used in the model and whether or not they are discrete or continuously distributed."

cd_desc <- "This table contains names and ranges for each continuously distributed state variable in the model, as well as which kernels they apply to."

ir_desc <- "This table contains information on how each continuous state variable is numerically approximated in the model (i.e. number of meshpoints, which integration rule was used)."

ps_desc <- "This table contains the names of the population trait distributions used in the model (i.e. the $n(z,t)$/$n(z,t+1)$ from Equation 1)."

ik_desc <- "This table contains the functional forms of each sub-kernel in the IPM (e.g. $P(z',z) = s(z) * G(z',z)$ in Equation 2 is entered as `P = s * G`), and information on which traits it acts on and creates. This table makes use of _ipmr_'s parameter set index notation to concisely represent models which may produce many kernels."

vr_desc <- "This table contains the functional forms of each vital rate in the IPM (e.g. $\\mu_G(z) = \\alpha_G + \\beta_G * z$ from Equation 5 is entered as `mu_g = int_g + slope_g * z_1`). This table makes use of _ipmr_'s parameter set index notation to concisely represent models which may produce many kernels."

pv_desc <- "This table contains the names and values of each parameter in the model, with the exception of parameters that are associated with continuous environmental variation."

ev_desc <- "This table contains parameter values and functional forms of any continuously varying environmental conditions (e.g. precipitation, temperature). Any model that contains information in this table is considered stochastic by default, as these variables must be sampled at least once to construct a model with _RPadrino_."

pi_desc <- "This table contains the parameter set indices. These are substituted into the IPM kernels and vital rate expressions when a model is built, so that a single symbolic expression can represent an arbitrary number of realized expression. For example, the vital rate expression `mu_g_yr = g_int_yr + g_slope * z_1` can be used to represent a range of years for a model with year-specific intercepts. This table contains values substituted in for `'_yr'` across the model. See the [ipmr vignette on Index Notation](https://levisc8.github.io/ipmr/articles/index-notation.html) for more details."

col_df <- data.frame(
  tab_nm = c("Metadata", 
             "State Variables",
             "Continuous States",
             "Integration Rules",
             "Population Trait Distributions",
             "IPM Sub-kernels",
             "Vital Rate Functions",
             "Parameter Values",
             "Continuous Environmental Variation",
             "Parameter Set Indices"),
  description = c(md_desc,
                  sv_desc,
                  cd_desc,
                  ir_desc,
                  ps_desc,
                  ik_desc,
                  vr_desc,
                  pv_desc,
                  ev_desc,
                  pi_desc) 
)

knitr::kable(col_df,
             col.names = c("Table", "Description"),
             caption = cap)

```

```{r echo = FALSE}

cap <- "**Table 2**: The number of studies in PADRINO broken down by kingdom. These represent the number of models that are error checked and considered production quality (see 'Data Validation' for more details). Models that are entered, but do not pass error checking are not considered here."
  
knitr::kable(tot,
             col.names = c("Kingdom", 
                           "# of Unique ipm_id's", 
                           "# of Unique Species",
                           "# of Publications"),
             caption = cap)

```

## Data Validation

PADRINO has automated testing built into the data release process. All models are checked to ensure they recover the behavior of the published version. Because publications vary greatly in their goals, this can encompass a variety of metrics. In most cases, this means reproducing the kernel-specific asymptotic population growth rate to a given tolerance level (usually to within $\pm 0.03$ of the published per-capita growth rate). It is worth noting that this margin of error is considerably less than the uncertainty that arises from fitting statistical models to the raw data used to fit the IPM, and so should be acceptable for almost any application. For stochastic models with continuously varying environments, it is often not computationally feasible to re-run the IPM for 10-50,000 iterations. Thus, we manually check for shorter term behavior that is similar to published dynamics (e.g. $\lambda_s$ after 1000 iterations). For publications where this type of information is not available, we manually examine the publication and check the entered model against some reported behavior. A model cannot enter a released version of the database unless it is explicitly flagged by a digitizer as validated, or passes its automated test. The manual testing functionality is contained in the open source _R_ package _pdbDigitUtils_ (available on [GitHub](https://github.com/levisc8/pdbDigitUtils)), and PADRINO's build scripts are in the project's [GitHub repository](https://github.com/levisc8/Padrino). 

## RPadrino

The syntax described above is unlikely to be useful on its own. _RPadrino_ is an _R_ package that contains functions for downloading the PADRINO database, data querying and management, and modifying existing functional forms and parameter values. _RPadrino_ also provides wrappers around functions from _ipmr_, an engine for implementing IPMs in _R_ (Levin et al. 2021). These wrappers translate PADRINO's syntax into _ipmr_'s syntax. This enables users to select appropriate models using the provided metadata, and then reconstruct the IPMs with only a few function calls. Additionally, _RPadrino_ leverages a common data structure from _ipmr_ to represent IPM objects, the `proto_ipm`, to facilitate combining user-specified IPMs with ones from PADRINO. We provide a number of worked examples of how to work with the database and package in the Supplementary Materials, and the package contains vignettes on further usage on [RPadrino's webpage](https://levisc8.github.io/RPadrino/).

# Challenges

The digitization effort is not without issues, some of which are imminently fixable. First, it is often the case that the complete form of the IPM is not reported. Many studies may report the general form of the model (e.g. something like Equation 1), but do not then report the functional forms of the sub-kernels or vital rates. Second, parameter values may be missing - common culprits are terms for the standard deviation/variance of the growth/fecundity kernels, number of meshpoints, and integration limits. These are crucial to our ability to reproduce these models. It is worth noting that most major publishers require that readers would be able to reproduce an analysis given the contents of the methods and supplementary information. In light of this, a requirement to report these values should not be seen as onerous. 

In addition to the challenges on the data digitization side, there are challenges in the reconstruction of these models too. _ipmr_ is not yet able to handle two-sex models, time-lagged models, or periodic models. These types of IPMs do not yet represent a substantial portion of the literature, but it is worth noting that IPMs like these won't be appearing in PADRINO's initial releases. Furthermore, _ipmr_ is still under active development and new classes of IPMs are expected to be implemented in the not too distant future, alleviating this concern. 


```{r echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Cumulative number of publications in Padrino by year, and their geographic distribution. The map panel only contains fully digitized publications - there are many more that are in progress but not yet complete."}

met <- pdb$Metadata

pub_rates <- ipm_pubs %>%
  filter(!duplicated(ipm_id)) %>%
  group_by(Year, Kingdom) %>%
  summarise(n_tot = n()) %>%
  ungroup() %>%
  arrange(Year) %>%
  group_by(Kingdom) %>% 
  mutate(run_sum = cumsum(n_tot)) %>% 
  filter(!is.na(Kingdom))

wrld_data <- met %>%
  mutate(lat = as.numeric(lat),
         lon = as.numeric(lon)) %>%
  filter(!is.na(lat) | !is.na(lon))

wrld <- map_data("world")

rate_plt <- ggplot(pub_rates,
                   aes(x = Year,
                       y = run_sum,
                       color = Kingdom)) +
  geom_line(size = 1.25) +
  theme_bw() +
  ylab("Cumulative Publications") +
  xlab("Year") + 
  scale_color_manual(
    breaks = c("Animalia", "Plantae"),
    values = c("red", "black")
  )

wrld_plt <- ggplot(wrld,
                   aes(x     = long,
                       y     = lat,
                       group = group)) +
  geom_polygon(color = "grey50",
               fill = NA) + 
  coord_map(xlim = c(-180, 180)) +
  geom_point(data = wrld_data,
             aes(x = lon,
                 y = lat),
             color = "blue",
             size = 1.5,
             alpha = 0.6,
             inherit.aes = FALSE) +
  theme_bw() +
  xlab("Longitude") +
  ylab("Latitude")

grid.arrange(wrld_plt, rate_plt,
             layout_matrix = matrix(c(1, 1,
                                      1, 1,
                                      1, 1,
                                      2, 2,
                                      2, 2),
                                    nrow = 5,
                                    ncol = 2,
                                    byrow = TRUE))

```


# Opportunities and Future Directions

PADRINO is designed to integrate with data from other databases. Its Metadata table closely resembles that of COMPADRE's, meaning that users which are familiar with that database should find a smooth transition to working with PADRINO. Furthermore, we provide a comprehensive set of metadata that allows users to match information in PADRINO with other databases, including, for example, gridded climate data, functional trait information, and phylogenetic information. 

PADRINO presents unique opportunities for synthesis in both theoretical and applied contexts. The expanded range of species and geographical coverage can be used in conjunction with other demographic databases (e.g. COM(P)ADRE (Salguero-Gomez et al. 2015, Salguero-Gomez et al. 2016), popler (Compagnoni et al. 2019), DatLife (DatLife 2021)) to power larger scale syntheses than were possible before (e.g. Compagnoni et al. 2021b). Furthermore, recent recent developments in combining biotic and abiotic interactions into IPMs provide a theoretical toolbox for exploring species responses to climate change (Simmonds et al. 2020, Abrego et al. 2021). Finally, PADRINO also provides functionality to modify parameter values and functional forms of the IPMs it stores, giving theoreticians a wide array of realistic life histories to experiment with. This is far from an exhaustive list, but hopefully demonstrates the variety of potential applications for this new tool in demography, ecology, and evolutionary biology. 

```{r echo = FALSE, message = FALSE, warning = FALSE}

library(knitr)

met_tab <- data.frame(
  concept = c(
    NA_character_,
    "Taxonomy",
    rep(NA_character_, 10),
    "Source",
    rep(NA_character_, 8),
    "Temporal Metadata",
    rep(NA_character_, 5),
    "Spatial Metadata",
    rep(NA_character_, 7),
    "Model-specific metadata",
    rep(NA_character_, 7)
  ),
  var_nm = c(
    "ipm_id",
    "species_author",
    "species_accepted", 
    "tax_genus", 
    "tax_family", 
    "tax_order", 
    "tax_class",
    "tax_phylum",
    "kingdom", 
    "organism_type", 
    "dicot_monocot", 
    "angio_gymno", 
    "authors",
    "journal", 
    "pub_year", 
    "doi", 
    "corresponding_author", 
    "email_year",
    "remark", 
    "apa_citation",
    "demog_appendix_link", 
    "duration",
    "start_year", 
    "start_month", 
    "end_year",
    "end_month", 
    "periodicity", 
    "population_name", 
    "number_populations", 
    "lat", 
    "lon",
    "altitude", 
    "country", 
    "continent", 
    "ecoregion", 
    "studied_sex", 
    "eviction_used", 
    "evict_type",
    "treatment", 
    "has_time_lag", 
    "has_age",
    "has_dd",
    "is_periodic"
  ),
  Description = c(
    "Unique ID for each model",
    "The Latin species name used by the authors of the paper",
    "The Latin species name accepted by XYZ Service",
    "The Latin genus name accepted by XYZ Service",
    "The Latin family name accepted by XYZ Service",
    "The Latin order name accepted by XYZ Service",
    "The Latin class name accepted by XYZ Service",
    "The Latin phylum name accepted by XYZ Service",
    "The Latin kingdom name accepted by XYZ Service",
    "General functional type of the species (e.g. annual, fern, mammal, reptile)",
    "If a plant species, whether the species is a dicot or a monocot",
    "If a plant species, whether the species is an angiosperm, gymnosperm, or neither",
    "All of a study authors' last names, separated with a ';'",
    "Abbreviated journal name (www.abbreviations.com/jas.php), or 'PhD', 'MSc' if a thesis",
    "The year of publication",
    "Digital object identifier and/or ISBN (if available)",
    "The name of the corresponding author on the paper",
    "The email address of the corresponding author and the year it was extracted (some email addresses may be defunct now)",
    "Additional remarks from the digitizer regarding the publication, if any",
    "The full APA citation for the source",
    "The URL for the Supplementary information containing additional model details, if available",
    "The duration of the study, defined 'study_end - study_start + 1'. Does not consider skipped years",
    "The year demographic data collection began",
    "The month demohraphic data collection began",
    "The year demographic data collection ended",
    "The month demographic data collection ended",
    "Frequency of the model (1: annual transition, 2: semi-annual transition, 0.2: 5 year transition)",
    "The name of the population given in the data source",
    "The number of populations that a given model describes",
    "The decimal latitude of the population",
    "The decimal longitude of the population",
    "The altitude of the population above sea level, obtained either from the publication or Google Earth",
    "The country or countries in which the data were collected",
    "The continent or continents on which the data were collected",
    "The terrestrial or aquatic ecoregion corresponding to Olson et al. (2001) classification. If data are from a controlled setting (greenhouse, lab), denoted with 'LAB'",
    "Sexes used to construct the model",
    "Whether or not the authors explicitly state that they corrected for eviction (see Williams et al. 2012)",
    "If the authors did correct for eviction, then the type of correction that was applied",
    "A description of any experimental treatment applied to the population",
    "Whether or not the model contains a time lagged vital rate/kernel",
    "Whether or not the model has age structure in addition to other continuous state variables",
    "Whether or not the model is density dependent",
    "Whether or not the model is periodic"
  )
  
)

met_tab$concept[is.na(met_tab$concept)] <- ""


kable(met_tab)
```
    
    
## Citations

1. Easterling, M.R., Ellner, S.P., & Dixon, P.M. (2000). Size specific sensitivity: applying a new structured population model. Ecology 81(3): 694-708.

2. Ellner, S.P. & Rees, M. (2006). Integral Projection Models for species with complex demography. The American Naturalist 167(3): 410-428.

3. Hartemink, N., & Caswell, H. (2018). Variance in animal longevity: contributions of heterogeneity and stochasticity. Population Ecology 60: 89-99. https://doi.org/10.1007/s10144-018-0616-7

4. DATLife ‚Äì The Demography Across the Tree of Life ‚Äì database. Max-Planck Institute for Demographic Research (Germany). Available at www.datlife.org. (2021)

5. Salguero‚ÄêG√≥mez, R., Jones, O.R., Archer, C.R., Bein, C., de Buhr, H., Farack, C., Gottschalk, F., Hartmann, A., Henning, A., Hoppe, G., Roemer, G., Ruoff, T., Sommer, V., Wille, J. Voigt, J., Zeh, S., Vieregg, D., Buckley, Y.M., Che-Castaldo, J., Hodgson, D., et al. (2016) COMADRE: a global database of animal demography. Journal of Animal Ecology 85: 371-384. https://doi.org/10.1111/1365-2656.12482

6. Salguero-G√≥mez, R, Jones, O.R., Archer, C.A., Buckley, Y.M., Che-Castaldo, J., Caswell, C., Hodgson, D., Scheuerlein, A., Conde, D.A., Brinks, E., de Buhr, H., Farack, C., Gottschalk, F., Hartmann, A., Henning, A., Hoppe, G., Roemer, G., Runge, J., Ruoff, T., et al. (2014) The COMPADRE Plant Matrix Database: an online repository for plant population dynamics. Journal of Ecology 103: 202-218. https://doi.org/10.1111/1365-2745.12334

7. Compagnoni, A., Pardini, E., & Knight, T.M. (2021a). Increasing temperature threatens an already endangered coastal plant species. Ecosphere 12(3): e03454. https://doi.org/10.1002/ecs2.3454

8. Compagnoni, A., Levin, S.C., Childs, D.Z., Harpole, S., Paniw, M., Roemer, G., Burns, J.H., Che-Castaldo, J., Rueger, N., Kunstler, G., Bennett, J.M., Archer, C.R., Jones, O.R., Salguero-Gomez, R., & Knight, T.M. (2021b). Herbaceous perennial plants with short generation time have stronger responses to climate anomalies than those with longer generation time. Nature Communications 12: 1824. https://doi.org/10.1038/s41467-021-21977-9

9. Levin, S.C., Childs, D.Z., Compagnoni, A., Evers, S., Knight, T.M., & Salguero-Gomez, R. (2021) ipmr: Flexible implementation of Integral Projections Models in R. Methods in Ecology and Evolution. https://doi.org/10.1111/2041-210X.13683

10. Jongejans, E., Shea, K., Skarpaas, O., Kelly, D., & Ellner, S.P. (2011). Importance of individual and environmental variation for invasive species spread: a spatial integral projection model. Ecology 92(1): 86-97. https://doi.org/10.1890/09-2226.1

11. Jelbert, K., Buss, D., McDonald, J., Townley, S., Franco, M., Stott, I., Jones, O., Salguero-Gomez, R., Buckley, Y., Knight, T.M., Silk, M., Sargent, F., Rolph, S., Wilson, P., & Hodgson, D. (2019). Demographic amplification is a predictor of invasiveness among plants. Nature Communications 10: 5602. https://doi.org/10.1038/s41467-019-13556-w 

12. Erickson, R.A., Eager, E.A., Brey, M.B., Hansen, M.J., & Kocovsky, P.M. (2017). An integral projection model with YY-males and application to evaluating grass carp control. Ecological Modelling 361: 14-25. https://doi.org/10.1016/j.ecolmodel.2017.07.030

13. Childs, D.Z., Rees, M., Rose, K.E., Grubb, P.J., & Ellner, S.P. (2004). Evolution of size-dependent flowering in a variable environment: construction and analysis of a stochastic integral projection model. Proceedings of the Royal Society B 271(1547): 425-434. https://doi.org/10.1098/rpsb.2003.2597

14. Ellner, S.P., Childs, D.Z., Rees, M. (2016) Data-driven modelling of structured populations: a practical guide to the integral projection model. Basel, Switzerland: Springer International Publishing AG

15. Leslie, P.H. (1945). The use of matrices in certain population mathematics. Biometrika 33(3): 183-212.

16. Caswell, H. (2001) Matrix population models: construction, analysis, and interpretation, 2nd edn. Sunderland, MA: Sinauer Associates Inc

17. Adler, P.B., Ellner, S.P. & Levine, J.M. (2010). Coexistance of perennial plants: an embarassment of niches. Ecology Letters 13: 1019-1029. https://doi.org/10.1111/j.1461-0248.2010.01496.x

18. Abrego, N., Roslin, T., Huotari, T., Ji, Y., Schmidt, N.M., Wang, J., Yu, D.W., & Ovaskainen, O. (2021) Accounting for species interactions is necessary for predicting how arctic arthropod communities respond to climate change. Ecography. https://doi.org/10.1111/ecog.05547 

19. Henry, L., & Wickham, H. (2021). rlang: Functions for Base Types and Core R and 'Tidyverse' Features. R package version 0.4.11. https://CRAN.R-project.org/package=rlang

## Acknowledgments

Funding: R.S-G. was supported by a NERC Independent Research Fellowship (NE/M018458/1). SCL, AC, SE, and TMK were funded by the Alexander von Humboldt Foundation in the framework of the Alexander von Humboldt Professorship of TM Knight endowed by the German Federal Ministry of Education and Research. 

Author Contributions: RSG, TMK, DZC, AC, and SCL designed the database. SE, TP, MP-G and SCL collected the data. SCL implemented _RPadrino_ and _pdbDigitUtils_. All authors contributed to the manuscript.
